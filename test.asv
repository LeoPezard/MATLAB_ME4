clear
close all
clc

L = 0.5;
l = 0.03;
e = 0.001;

Tinf = 29;
T0 = 53;


tspan = linspace(0,1000,6);
xspan = linspace(0,L,40);

h = 62;
k = 390;
S = l*e;
P = 2*l+2*e;


pdexlic = @(x)[200];

% Pour pouvoir utiliser les coefficients k, rho et Cp dans la fonction
% pdex1pde dans l'autre fichier
pdefun = @(x,t,u,DuDx) pdex1pde(x,t,u,DuDx,k,rho,Cp);

sol = pdepe(m,pdefun,pdexlic,@pdex1bc, xspan, tspan);

% 
figure;
hold on;
for i = 1:length(tspan)
    u=sol(i,:,1)
    plot(xspan,u,'DisplayName', [' t =', num2str(tspan(i)),' sec']);
end
legend show;
xlabel('x (m)');
ylabel('T(x,t)');
title('Ã‰volution de T(x,t) dans le temps');

figure;
u_2 = sol(:,:,1);
surf(xspan, tspan,u_2);